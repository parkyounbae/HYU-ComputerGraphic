```
컴퓨터 그래픽스 : Project 03
2019038513 박윤배
```
# 기능구현

### BVH Viewer & Drag-Drop

BVH파일을 화면에 Drag-Drop 한다면 filecallback을 통해 파일을 불러와 파싱을 시작합니다.
각각 ROOT, JOINT, END를 구분하여 파싱합니다. ROOT, JOINT인 경우 관절을 추가해 주고
JOINT,END인 경우에는 뼈대를 추가해줍니다. 이때 관절은 (0,0,0)으로 scale해주어 실제로
랜더링 할때는 보이지 않게 해준다.
항상 이동벡터 기준은 (0,1,0)으로 해주어야 하기 때문에 뼈대는 해당 방향으로 뻗어나
가게 회전해주고 이후 그 끝에 추가되는 관절은 다시 (0,1,0)을 바라보게 값을 곱해주어
야 한다. 그렇기 때문에 뼈대에는 (0,1,0)을 원하는 방향으로 회전하게 하는 rotaAon_mat
을 적용하고 관절에는 뼈대의 방향에서 다시 (0,1,0)을 바라보게 하는 rotaAon_mat2를 적
용해준다.
또한 관절의 경우 스택에 넣어 이후에 생성되는 뼈대의 부모의 역할을 할 수 있도록 한
다. END 를 인식한 이후에는 } 의 개수에 따라 스택에서 pop을 해주어 각 뼈대가 올바른
관절을 부모로 가질 수 있도록 한다.
이외에도 노드 생성에 필요한 채널정보, 이름, 위치 정보들을 사용하여 노드 리스트를
채워준다. 노드 리스트를 완성한 이후에는 모션 정보를 파싱하는데 이는 나중에 한번에
하기 위해 라인 단위로 리스트에 저장한다. 실제 파싱을 모션을 적용할때 파싱하도록 한
다.
마지막으로 제각각 크기인 파일들을 일관적인 크기로 볼 수 있도록 오프셋들의 길이 중
가장 긴 값을 구하여 해당 비율만큼 작아지게 scale을 해준다. 이를 최 상단의 루트 노드
에 적용하여 이후에 자연스럽게 자식 노드들에게도 적용될 수 있도록 한다.

## Two Rendering Mode

#### 기본적으로 제공하는 모드는 박스를 통한 랜더링이다. 각각의 노드에 크기, 회전, 이동

정보가 담겨있기 때문에 하나의 box_vao를 사용하여 전체 그림을 랜더링 할 수 있었다.
박스의 크기는 (-1,-1,-1) ~ (1,1,1) 까지로 이루어져 있어 스케일 함수를 적용하였을 때 비율
에 맞게 조정될 수 있게 하였다. 라인 모드로 바꾸게 되면 (0,1,0) ~ (0,-1,0) 까지의 직선을
이용한 vao로 랜더링을 대체한다. 이는 간단히 vao종류만 바꿔주면 되는 것이기 때문에
애니메이션이 작동중일 때에도 자연스럽게 바뀔수 있다.

## Anima0on

#### 드래그-드랍 이후 초기 모델링의 자세는 아무런 회전이 적용되지 않은 오프셋 정보로만

#### 이루어진 랜더링이다. 이때 스페이스바를 눌러 애니메이션 모드를 실행시키면 이전에 저

장해둔 moAon 값들을 통해 관절들을 회전시킨다. 이때 프레임이 중요한데 현재시각-실행
시작시각 값을 이용해 실행 시간을 알 수 있고 이를 통해 원하는 프레임에 맞게 관절들


#### 을 회전 및 이동시킬 수 있다. 이때 각 관절들마다 회전 순서가 다를수도 있기 때문에

#### 파싱을 하여 각각의 회전 축을 파악하여 순서에 맞는 결과 값을 구한 뒤 해당 관절의 회

전값에 적용시켜준다. 적용 이후 랜더링 시에 루트 노드의 update_tree_global_transform
함수를 이용해 해당 트리에 속한 모든 노드들에 움직임들을 적용해준다.

## 스크린샷

## 링크

hNps://youtube.com/shorts/xpSVdGFcfUA?feature=share


